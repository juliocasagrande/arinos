<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Visualização de Dados dos Parques Solares</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        /* Define que cada gráfico ocupe 100% da largura da página */
        #plots {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .plot-container {
            width: 90%; /* Ocupa 90% da largura da tela, ajuste se necessário */
            max-width: 1200px; /* Limita a largura máxima */
            margin-bottom: 40px; /* Espaçamento entre gráficos */
        }
    </style>
</head>
<body>

<h1>Visualização de Dados dos Parques Solares</h1>
<div id="plots"></div>

<script>
    // Lista dos nomes dos parques que correspondem aos arquivos JSON
    const parques = ["ARN08", "ARN09", "ARN10"];  // Atualize com os nomes reais dos arquivos JSON

    // Função para carregar e exibir dados de cada parque
    async function carregarDados(parque) {
        const response = await fetch(`${parque}.json`);  // Acessa diretamente o arquivo JSON na raiz
        const data = await response.json();

        // Extrair dados para gráficos
        const datas = data.map(d => new Date(d.Data));
        const irradiancia = data.map(d => d['P_GHI_1 Value']);
        const angulo = data.map(d => d['_POA_ANG Value']);
        const temperatura = data.map(d => d['_T_INT Value']);

        // Criar traces para cada variável
        const traceIrradiancia = {
            x: datas,
            y: irradiancia,
            mode: 'lines',
            name: 'Irradiância',
            line: { color: 'rgba(0, 0, 255, 0.5)' }
        };

        const traceAngulo = {
            x: datas,
            y: angulo,
            mode: 'lines',
            name: 'Ângulo Tracker',
            yaxis: 'y2',
            line: { color: 'rgba(0, 128, 0, 0.5)' }
        };

        const traceTemperatura = {
            x: datas,
            y: temperatura,
            mode: 'lines',
            name: 'Temperatura',
            yaxis: 'y2',
            line: { color: 'rgba(255, 0, 0, 0.5)' }
        };

        // Configuração do layout com eixo secundário
        const layout = {
            title: `Dados do Parque: ${parque}`,
            xaxis: { title: 'Data' },
            yaxis: { title: 'Irradiância' },
            yaxis2: {
                title: 'Ângulo e Temperatura',
                overlaying: 'y',
                side: 'right'
            },
            width: null,  // Define a largura automaticamente (ocupa 100% do contêiner)
            height: 400,
            plot_bgcolor: "rgba(0,0,0,0)"  // Fundo transparente
        };

        // Renderizar gráfico no div com ID "plots"
        const plotDiv = document.createElement('div');
        plotDiv.className = 'plot-container';
        document.getElementById('plots').appendChild(plotDiv);

        Plotly.newPlot(plotDiv, [traceIrradiancia, traceAngulo, traceTemperatura], layout);
    }

    // Carregar e exibir gráficos para cada parque
    parques.forEach(parque => carregarDados(parque));
</script>

</body>
</html>
